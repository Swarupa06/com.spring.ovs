package com.spring.ovs.service;

import java.util.ArrayList;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.spring.ovs.dtos.Login;
import com.spring.ovs.exceptions.InvalidOperation;
import com.spring.ovs.repository.LoginRepository;
import com.spring.ovs.utility.ValidateLogin;

@Service
public class LoginService {
@Autowired
private LoginRepository loginRepo;

/*
 * This method used for getting the login details by id , if id is existing we can get its details the details.
 */
public Login getLoginById(Integer id) throws InvalidOperation {
	try {
		return loginRepo.findById(id).get();
	}
	catch(InvalidOperation e) {
		System.out.println("Login could not find");
		e.printStackTrace();
		return null;
	}
}

/*
 * This method used for inserting the logins, if login do not match with the validation, login cannot be updated.
 */
public Login insertLogin(Login login) {
	
	String name=login.getLoginName();
	
	if(name.matches(ValidateLogin.nameregex) && login.getLoginPassword().matches(ValidateLogin.passwordregex))
	{
		return loginRepo.save(login);
	}
	
	else{
		
		throw new InvalidOperation("Login not inserted");
	}

}

/*
 * This method used for updating the Login details, if Login matches validation, can update the details.
 */
public Login updateLogin(Login login) throws InvalidOperation {
	if(login!=null && login.getLoginName().matches(ValidateLogin.nameregex) && login.getLoginPassword().matches(ValidateLogin.passwordregex))
	{
		loginRepo.save(login);
		return login;
	}
	else
	{
		throw new InvalidOperation("Login not updated");
		
	}
}

/*
 * This method used for deleting the login by id, if id is existing we can delete the login.
 */
public int deleteLoginbyId(Integer id)throws InvalidOperation {
	try {
		  loginRepo.deleteById(id);
		return id;
	}
	catch(InvalidOperation ie)
	{
		throw new InvalidOperation("Login not deleted");
	}

}

/*
 * This method used for view all the login details.
 */
public List<Login> getAllLogins() {
	List<Login> loginlist=new ArrayList<Login>();
	loginRepo.findAll().forEach(login->loginlist.add(login));
	return loginlist;
}

}
